<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>User Profile</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .profile { max-width: 700px; margin: 0 auto; }
    .profile-header { display: flex; align-items: center; justify-content: space-between; }
    .profile-info { display: flex; gap: 20px; align-items: center; }
    .avatar { width: 80px; height: 80px; border-radius: 50%; background: #ddd; display: inline-block; }
    .profile-details { line-height: 1.2; }
    #profileEditDropdown { display: none; margin-top: 16px; border: 1px solid #e1e1e1; padding: 12px; border-radius: 6px; background: #fafafa; }
    .form-row { margin-bottom: 10px; }
    label { display: block; margin-bottom: 4px; font-weight: bold; }
    input[type="text"], input[type="email"], textarea { width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
    button { padding: 8px 12px; border: 1px solid #888; border-radius: 4px; background: #f0f0f0; cursor: pointer; }
    button.primary { background: #0366d6; color: white; border-color: #0366d6; }
  </style>
</head>
<body>
  <div class="profile">
    <div class="profile-header">
      <div class="profile-info">
        <div class="avatar" aria-hidden="true"></div>
        <div class="profile-details">
          <h2 id="profileUsername">Jane Doe</h2>
          <div id="profileEmail">jane.doe@example.com</div>
        </div>
      </div>

      <!-- Replaced previous edit toggle with an Edit button -->
      <div>
        <button id="profileEditButton" aria-expanded="false" aria-controls="profileEditDropdown">Edit</button>
      </div>
    </div>

    <!-- Profile content / bio -->
    <section style="margin-top: 14px;">
      <h3>About</h3>
      <p id="profileBio">This is a short bio about the user. It can be edited using the Edit button above.</p>
    </section>

    <!-- The profile edit form is now wrapped in this dropdown and hidden by default -->
    <div id="profileEditDropdown" aria-hidden="true">
      <form id="profileEditForm" method="post" action="/profile/update">
        <div class="form-row">
          <label for="name">Name</label>
          <input type="text" id="name" name="name" value="Jane Doe" required>
        </div>
        <div class="form-row">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" value="jane.doe@example.com" required>
        </div>
        <div class="form-row">
          <label for="bio">Bio</label>
          <textarea id="bio" name="bio" rows="4">This is a short bio about the user. It can be edited using the Edit button above.</textarea>
        </div>

        <div style="display:flex; gap:8px; align-items:center;">
          <button type="submit" class="primary">Save</button>
          <button type="button" id="profileEditCancel">Cancel</button>
        </div>

        <!-- Note: The remove button has intentionally been removed. -->
      </form>
    </div>
  </div>

  <script>
    (function () {
      var editButton = document.getElementById('profileEditButton');
      var dropdown = document.getElementById('profileEditDropdown');
      var cancelBtn = document.getElementById('profileEditCancel');

      function showDropdown() {
        dropdown.style.display = 'block';
        dropdown.setAttribute('aria-hidden', 'false');
        editButton.setAttribute('aria-expanded', 'true');
      }

      function hideDropdown() {
        dropdown.style.display = 'none';
        dropdown.setAttribute('aria-hidden', 'true');
        editButton.setAttribute('aria-expanded', 'false');
      }

      // Toggle on button click
      editButton.addEventListener('click', function (e) {
        if (dropdown.style.display === 'none' || dropdown.style.display === '') {
          showDropdown();
        } else {
          hideDropdown();
        }
      });

      // Cancel hides the dropdown without submitting
      cancelBtn.addEventListener('click', function (e) {
        hideDropdown();
      });

      // Close dropdown when clicking outside of it
      document.addEventListener('click', function (e) {
        var target = e.target;
        if (!dropdown.contains(target) && target !== editButton) {
          hideDropdown();
        }
      });

      // Prevent clicks inside the dropdown from closing when document listener runs
      dropdown.addEventListener('click', function (e) {
        e.stopPropagation();
      });
    })();
  </script>
</body>
</html>
